18:28:24 -undefined- *** Processing connection to efnet.port80.se
18:28:24 -undefined- *** Looking up your hostname...
18:28:24 -undefined- *** Checking Ident
18:28:24 -undefined- *** Found your hostname
18:28:36 -undefined- *** No Ident response
18:28:36 -!- splunkbot has joined null
18:28:36 -!- cgales!~cgales@nat.splunk.com changed the topic of null to: Splunk> 4.3 Smells like red curry || http://www.splunk.com/download || http://splunk.pastebin.com || peak #splunk hours are PST/PDT
18:28:53 <  duckfez> oh my aching head
18:29:18 <  duckfez> we had a dns box push up daisies today, memory ECC fault was too much for it to hangle
18:29:31 <    cerby> eek. DNS needs to work.
18:29:56 <    cerby> ECC? Are you running on busted-assed Sun e4500s with the chips with ecache-parity errors in them?!
18:29:58 <  jrodman> once you do |stats, you've flattened tht data with respect to time
18:30:07 <  jrodman> not sure how you could get a timechart at that point
18:30:17 <  duckfez> yeah, the problem wasn't that the other DNS box didn't work, it was that the delay in realizing
18:30:38 <  duckfez> cerby: nah, it's a powerpc machine, but it's not exactly latest & greatest stuff
18:30:38 <    cerby> duck - about 4s of delay for every request.
18:30:54 <  duckfez> but, here's the sad part - we explain what happened
18:30:54 <    cerby> jrod - hmm, that's yucky. I'm trying to do SLA calculations for a 5 minute period.
18:31:08 <  jrodman> duckfez: modern dns resolver libraries seem reallly bad in trying dns #2
18:31:25 <  jrodman> duckfez: if you kill all the mdns and stuff, it seems to work okay, but you can't do that on every box
18:31:41 <  duckfez> get this response back,
18:31:47 <    cerby> jrod - ehh, I disagree. my experience is that the gethostbyname calls work fine, but, each time the are called, they pay the penalty to try the first resolver before failing over to the next one
18:32:04 <    cerby> they don't keep state when they don't get a response on prior requests.
18:32:09 <  jrodman> gethostbyname often works
18:32:39 <  jrodman> but not getaddrinfo
18:32:42 <    cerby> duck - haha. you need to blame hte ECC failure on the recent solar flair activity
18:33:02 <  duckfez> now, I'm all for improvement ... but zomg you'd think that it'd be obvious that nothing can prevent the occasional ECC fault
18:33:19 <    cerby> hmm
18:33:28 <  jrodman> cerby: understanding the problem may be hadr remotely (the search problem)
18:33:50 <    cerby> sure. one wouldn't want to try to grok what's wrong w/ the DNS server
18:33:53 <  duckfez> maybe I take things too literally, but this whole
18:33:56 <  jrodman> are you trying to figure out how many of the items are in a certain state per time quanta?
18:34:00 -!- edrabbit has quit IRC (null)
 undefined18:34:02 <    cerby> but a backoff timer that after X failures in a row, try the #2 resolver immediately
18:34:10 <    cerby> after Y period of time, try the first one again, see if it is up.
18:34:32 <  duckfez> yeah, the problem wasn't that we didn't have enough resolvers online, the problem was how the hosts handled one being down
18:34:39 <  jrodman> maybe you want to just mark them slow or not slow with an eval
18:34:50 <  jrodman> eval slow=blahblah()
18:34:57 <  jrodman> or like
18:34:58 <  jrodman> speed
18:35:00 <    cerby> oh, hrm. I think I may have figured this out before
18:35:01 <  jrodman> where speed is slow or ok
18:35:05 <    cerby> host=
18:35:26 <    cerby> that gives me a ratio of HTTP 500s vs 200's.
18:35:26 <  jrodman> okay
18:35:44 <    cerby> I need to move the time chart sooner in the line, and not use stats, but just a table at the end.
18:35:58 <   Coccyx> ok, well this is really freaking awesome
18:36:00 <    cerby> and then chart the result.
18:36:45 <  duckfez> cerby: because of the poorness of failover state and such in the base libc resolver stuff, we're pondering just sticking an lvs or other load balancer out in front ; let it keep state on who's working right/wrong
18:37:08 <    cerby> that would work
18:37:18 <    cerby> I've done that kinda stuff with ucarp before for NFS servers.
18:37:22 <   Coccyx> http://pastebin.com/hPrR9rXL
18:37:23 <  Splunky> Coccyx's URL:
18:37:30 <    cerby> have a floating IP between them, but it doesn't load balance, just does failover.
18:37:44 <   Coccyx> duckfez: LB in front of DNS is a necessity
18:37:59 <   Coccyx> unless you like your entire infrastructure taking a crap
18:38:32 <   Coccyx> yeah, floating IP works too... wackamole is good for that I here
18:38:47 <  duckfez> it's just the whole pet peeve of
18:39:04 <    cerby> host=
18:39:13 <    cerby> ah ha! got it. Real time SLA reporting, here I come.
18:39:17 <  duckfez> and I'm just bitching
18:39:28 <    cerby> \x01ACTION has just paid for his trip to Splunk Live! last week\x01
18:40:27 <  duckfez> nevermind we've found hosts doing 7,000 dns requests per minute for their own IP's PTR rec and their own A and AAAA recs
18:40:37 <    cerby> woo.
18:41:12 <  duckfez> java is such a pestilence
18:41:38 <  duckfez> some genius made java's resolver libs cache EVERYTHING FOREVER except for the local host name / ip
18:41:40 <   Coccyx> only thing worse than java is XML
18:41:50 <  duckfez> and, instead, it doesn't cache its own name AT ALL
18:41:59 -undefined- *** Processing connection to irc.choopa.net
18:41:59 -undefined- *** Looking up your hostname...
18:41:59 -undefined- *** Checking Ident
18:41:59 -undefined- *** Found your hostname
18:42:13 -undefined- *** No Ident response
18:42:16 -!- splunkbot has joined null
18:42:16 -!- cgales!~cgales@nat.splunk.com changed the topic of null to: Splunk> 4.3 Smells like red curry || http://www.splunk.com/download || http://splunk.pastebin.com || peak #splunk hours are PST/PDT
18:42:16 -!- edrabbit has joined null
18:42:27 <   Coccyx> ok, testing a fix... http://splunky.com/say/something/
18:42:30 <  Splunky> Coccyx's URL:
18:42:43 <  duckfez> why?  because in a DHCP environment, the name/IP of the local machine might change ...
18:43:08 <  duckfez> fully 90% of our DNS queries are java apps having an existential crisis
18:43:11 <  isnoop1> http://whatismyip.com/
18:43:14 <  Splunky> isnoop1's URL:
18:43:23 <  isnoop1> =P
18:43:27 -!-   isnoop1 is now known as isnoop
18:43:45 <    cerby> duck - ouch.
18:44:42 -undefined- *** Processing connection to irc.efnet.pl
18:44:42 -undefined- *** Looking up your hostname...
18:44:42 -undefined- *** Checking Ident
18:44:42 -undefined- *** No Ident response
18:44:42 -undefined- *** Found your hostname

